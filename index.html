<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jarne Beaufays — Portfolio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="theme.css">

  <style>
    .site-header {
      position: relative;
      background: transparent;
      isolation: isolate;
    }

    .site-header::before {
      content: "";
      position: absolute;
      inset: 0;
      background: var(--color-accent1);
      clip-path: polygon(0 0, 100% 0, 100% 75.7%, 0 100%);
      z-index: 0;
    }

    .project-card {
      transition: transform .28s cubic-bezier(.2, .9, .2, 1), box-shadow .28s;
      border-radius: var(--card-radius);
      overflow: hidden
    }

    .project-card:hover {
      transform: translateY(-6px) scale(1.03);
      box-shadow: var(--card-shadow)
    }

    .project-card img {
      transition: transform .6s ease
    }

    .project-card:hover img {
      transform: scale(1.06)
    }

    .decor-blob {
      position: absolute;
      right: -120px;
      top: -80px;
      width: 420px;
      height: 420px;
      border-radius: 50%;
      filter: blur(48px);
      opacity: .25;
      background: radial-gradient(circle at 30% 30%, var(), transparent 40%)
    }

    @media (min-width:1024px) {
      header .name-wrap {
        max-width: 65%
      }
    }

    .triangle-wrapper,
    .triangle-divider {
      position: relative;
      width: 100vw;
      left: 50%;
      margin-left: -50vw;
      overflow-x: hidden;
      overflow-y: visible;
      pointer-events: none;
      z-index: 0;
    }

    @media (min-width: 640px) {
      .triangle-wrapper {
        left: calc(50% - 1.5rem);
        margin-left: calc(-50vw + 1.5rem);
      }
    }

    .triangle-wrapper svg,
    .triangle-divider svg {
      display: block;
      width: 100%;
      overflow: visible;
      pointer-events: none;
    }

    .triangle-wrapper polygon,
    .triangle-divider polygon {
      pointer-events: auto;
      transform-box: fill-box;
      transform-origin: center;
      transition: transform .5s cubic-bezier(.2, .9, .2, 1), filter .28s ease;
      will-change: transform;
    }

    .triangle-wrapper polygon:hover,
    .triangle-divider polygon:hover {
      transform: scale(1.05);
    }

    .footer-cta {
      background: var(--color-accent2);
      clip-path: polygon(0 10%, 100% 0, 100% 100%, 0% 100%);
    }

    /* simple line-clamp helpers (no Tailwind plugin needed) */
    .line-clamp-1,.line-clamp-2,.line-clamp-3{
      display:-webkit-box;
      -webkit-box-orient:vertical;
      overflow:hidden
    }
    .line-clamp-1{-webkit-line-clamp:1}
    .line-clamp-2{-webkit-line-clamp:2}
    .line-clamp-3{-webkit-line-clamp:3}

    /* === Floating section navigation arrows === */
    .scroll-arrow {
      position: fixed;
      right: 1rem;
      z-index: 60;
      width: 2.75rem;
      height: 2.75rem;
      background: var(--color-accent1);
      color: white;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      line-height: 1;
      cursor: pointer;
      transition: opacity .25s ease, transform .15s ease;
      opacity: .9;
      box-shadow: 0 6px 16px rgba(0,0,0,.18);
      user-select: none;
    }
    .scroll-arrow:hover { opacity: 1; transform: translateY(-1px); }
    .scroll-arrow:active { transform: translateY(0); }
    .scroll-arrow.hidden { display: none; }
    .scroll-arrow.down { bottom: 1rem; }
    .scroll-arrow.up   { top: 1rem; }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      html:focus-within { scroll-behavior: auto; }
    }
  </style>

  <script>
    function normalizeType(t) {
      return String(t || "").toLowerCase().replace(/\s+/g, "");
    }

    function getPrimaryAccentColor(type) {
      switch (normalizeType(type)) {
        case "industryprojects":   return "--color-accent1";
        case "industryprototypes": return "--color-accent3";
        case "personalprojects":   return "--color-accent4";
        case "others":             return "--color-accent2";
        default:                   return "--color-accent1";
      }
    }

    function getSecondaryAccentColor(type) {
      switch (normalizeType(type)) {
        case "industryprojects":   return "--color-accent3";
        case "industryprototypes": return "--color-accent4";
        case "personalprojects":   return "--color-accent2";
        case "others":             return "--color-accent1";
        default:                   return "--color-accent3";
      }
    }
  </script>

  <script>
    function renderProjects({ data, gridId, type, limit = 3, alwaysShowAll = false }) {
      const grid = document.getElementById(gridId);
      if (!grid) return;

      // equal-height grid tracks
      grid.classList.add("items-stretch");

      // Filter & sort once
      const list = data
        .filter(p => (p.type || '').toLowerCase() === type.toLowerCase());
      // Build all cards once (we'll append/remove later)
      const cards = list.map(p => {
        const a = document.createElement("a");
        a.href = `project.html?slug=${encodeURIComponent(p.slug)}`;
        a.className = "block h-full";
        a.innerHTML = `
          <article class="project-card bg-white shadow-md h-full flex flex-col">
            <img
              src="${p.thumb}"
              alt="${p.title}"
              class="w-full h-72 object-cover"
              decoding="async"
              loading="lazy"
            />
            <div class="p-4 flex flex-col grow">
              <div class="flex items-center justify-between mb-2">
                <div class="flex flex-wrap gap-2">
                  ${[
                    ...(typeof p.client === "string" && p.client !== "" ? [p.client] : []),
                    ...(Array.isArray(p.tags) ? p.tags : [])
                  ].map((t, i) => `
                    <span class="cat-pill inline-block text-xs px-3 py-1 rounded-full"
                      style="background: var(${ i === 0 ? getPrimaryAccentColor(p.type)
                                                        : getSecondaryAccentColor(p.type) });">
                      ${t}
                    </span>`).join("")}
                </div>
                <span class="text-xs text-slate-400 whitespace-nowrap">${p.year || ""}</span>
              </div>
              <h3 class="text-lg font-bold mb-1 line-clamp-2">${p.title}</h3>
              <p class="text-sm text-slate-600 line-clamp-3">${p.short || ""}</p>
              <div class="mt-auto"></div>
            </div>
          </article>`;
        return a;
      });

      // Preload + decode hidden thumbs so first expand doesn't jolt
      if (!alwaysShowAll && list.length > limit) {
        const preloads = list.slice(limit).map(p => {
          const img = new Image();
          img.decoding = "async";
          try { img.fetchPriority = "low"; } catch {}
          img.src = p.thumb;
          img.addEventListener("load", () => img.decode?.().catch(() => {}));
          return img;
        });
        // keep a strong reference so GC doesn't drop them
        grid._preloadedThumbs = preloads;
      }

      // Initial render (no full re-render later)
      const initialCount = alwaysShowAll ? cards.length : Math.min(limit, cards.length);
      grid.append(...cards.slice(0, initialCount));

      // Show more / less (append/remove only the extras)
      if (!alwaysShowAll && cards.length > limit) {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.textContent = "Show more ↓";
        btn.className =
          "mt-6 px-4 py-2 bg-white hover:bg-[var(" + getPrimaryAccentColor(type) + ")] hover:text-white " +
          "rounded-lg text-sm block mx-auto shadow transition-colors";
        btn.dataset.expanded = "false";

        btn.addEventListener("click", () => {
          const expanded = btn.dataset.expanded === "true";

          if (expanded) {
            // collapse: remove extra children beyond 'limit'
            while (grid.children.length > limit) {
              grid.removeChild(grid.lastElementChild);
            }
            btn.textContent = "Show more ↓";
            btn.dataset.expanded = "false";
          } else {
            // expand: append remaining prebuilt cards
            grid.append(...cards.slice(grid.children.length));
            btn.textContent = "Show less ↑";
            btn.dataset.expanded = "true";
          }
        });

        grid.parentNode.appendChild(btn);
      }
    }
  </script>

</head>

<body class="antialiased text-slate-800" aria-busy="true">

  <!-- Loading overlay (visible until all sections finish parsing + rendering) -->
  <div id="loadingOverlay"
    class="fixed inset-0 z-[9999] flex flex-col items-center justify-center gap-4 bg-white/95 backdrop-blur-sm transition-opacity duration-300">
    <div class="h-10 w-10 rounded-full border-4 border-slate-300 border-t-slate-700 animate-spin" aria-hidden="true">
    </div>
    <p class="text-sm text-slate-600" role="status" aria-live="polite">Loading projects…</p>
    <noscript>
      <p class="text-xs text-slate-500">Enable JavaScript to load this page.</p>
    </noscript>
  </div>

  <script>
    (function () {
      const overlay = document.getElementById('loadingOverlay');
      let pending = 0;

      const show = () => {
        pending++;
        overlay.classList.remove('hidden', 'opacity-0');
        document.body.setAttribute('aria-busy', 'true');
      };
      const hide = () => {
        pending = Math.max(0, pending - 1);
        if (pending === 0) {
          overlay.classList.add('opacity-0');
          setTimeout(() => overlay.classList.add('hidden'), 250);
          document.body.removeAttribute('aria-busy');
        }
      };

      window.withLoading = async (fn) => {
        show();
        try {
          return await fn();
        } finally {
          hide();
        }
      };

      let projectsPromise = null;
      window.getProjects = function () {
        if (!projectsPromise) {
          projectsPromise = (async () => {
            const res = await fetch('projects.json', { cache: 'no-store' });
            if (!res.ok) throw new Error('Failed to load data');
            return res.json();
          })();
        }
        return projectsPromise;
      };
    })();
  </script>

  <!-- Header / Hero -->
  <header class="site-header text-white py-12 min-h-[300px] flex items-center">
    <div class="max-w-6xl mx-auto px-6 relative">
      <img src="Images/UrsaMajor.png" class="hidden md:block absolute w-96 h-auto pointer-events-none"
        alt="Ursa Major illustration">
      <div class="decor-blob" aria-hidden="true"></div>
      <div class="flex items-center  gap-24 translate-y-8">
        <div class="name-wrap relative">
          <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight leading-tight">Jarne Beaufays</h1>
          <p class="mt-2 text-md opacity-90">Belgian Game Programmer and Community Builder</p>
          <div class="mt-4 flex gap-3">
            <a href="resume.html"
              class="inline-block bg-white/10 hover:bg-white/20 text-white py-2 px-3 rounded-md text-sm">Resume</a>
            <a href="#contact"
              class="inline-block bg-white text-[var(--color-accent1)] font-semibold py-2 px-3 rounded-md text-sm">Contact</a>
          </div>
        </div>

        <div class="flex-shrink-0 -translate-y-6">
          <img src="Images/Jarne.jpg" alt="Jarne Beaufays"
            class="block w-80 h-80 sm:w-80 sm:h-80 rounded-full ring-[12px] ring-white shadow-lg object-cover">
        </div>

      </div>
    </div>
  </header>

  <!-- Main content -->
  <main class="max-w-7xl mx-auto px-6 py-12 space-y-16">

    <section>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-3xl font-semibold">Industry Projects</h2>
        <p class="text-sm text-slate-500">A selection of full pipeline games</p>
      </div>

      <!-- Industry Projects -->
      <div id="industry-projects-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6"></div>

      <script>
        withLoading(async () => {
          const data = await getProjects();
          renderProjects({
            data,
            gridId: "industry-projects-grid",
            type: "Industry Projects",
            alwaysShowAll: true
          });
        });      
      </script>
    </section>

    <!-- Triangle divider below Industry Projects -->
    <div class="triangle-wrapper" aria-hidden="true">
      <!-- viewBox expanded for bleed -->
      <svg width="100%" height="300" viewBox="0 0 100 100" preserveAspectRatio="none"
        xmlns="http://www.w3.org/2000/svg">
        <polygon points="3,3 70,15 6,85" fill="var(--color-accent1)" />
        <polygon points="98,4 97,97 40,62" fill="var(--color-accent3)" />
      </svg>
    </div>

    <!-- Industry Prototypes -->
    <section>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-3xl font-semibold">Industry Prototypes</h2>
        <p class="text-sm text-slate-500">Smaller industry prototypes</p>
      </div>

      <div id="industry-prototypes-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      <script>
        withLoading(async () => {
          const data = await getProjects();
          renderProjects({
            data,
            gridId: "industry-prototypes-grid",
            type: "Industry Prototypes",
            limit: 3
          });
        });
      </script>
    </section>

    <!-- Triangle divider below Personal Projects -->
    <div class="triangle-wrapper -translate-y-8" aria-hidden="true">
      <svg width="100%" height="230" viewBox="0 0 100 100" preserveAspectRatio="none"
        xmlns="http://www.w3.org/2000/svg">
        <polygon points="8,3 40,25 10,98" fill="var(--color-accent3)" />
        <polygon points="92,4 94,96 50,60" fill="var(--color-accent4)" />
      </svg>
    </div>

    <!-- Personal Projects -->
    <section>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-3xl font-semibold">Personal Projects</h2>
        <p class="text-sm text-slate-500">A selection of game jams, side projects, and experimentations</p>
      </div>

      <div id="personal-projects-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      <script>
        withLoading(async () => {
          const data = await getProjects();
          renderProjects({
            data,
            gridId: "personal-projects-grid",
            type: "Personal Projects",
            limit: 3
          });
        });
      </script>
    </section>

    <!-- Triangle divider below Industry Prototypes -->
    <div class="triangle-wrapper -translate-y-8" aria-hidden="true">
      <svg width="100%" height="300" viewBox="0 0 100 100" preserveAspectRatio="none"
        xmlns="http://www.w3.org/2000/svg">
        <polygon points="3,3 56,45 20,91" fill="var(--color-accent4)" />
        <polygon points="96,4 97,97 28,91" fill="var(--color-accent2)" />
      </svg>
    </div>

    <!-- Others -->
    <section>
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-3xl font-semibold">Others</h2>
        <p class="text-sm text-slate-500">Events, community work, and relevant hobbies</p>
      </div>

      <div id="others-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

      <script>
        withLoading(async () => {
          const data = await getProjects();
          renderProjects({
            data,
            gridId: "others-grid",
            type: "Others",
            limit: 3
          });
        });
      </script>
    </section>

    <!-- Resume -->
    <section id="resume">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-3xl font-semibold">
          To view my resume, click
          <a href="resume.html" class="text-[var(--color-accent2)] underline hover:no-underline" target="_blank"
            rel="noopener noreferrer">
            here</a>
          !
        </h2>
      </div>
    </section>

  </main>

  <footer class="footer-cta text-white">
    <div class="max-w-7xl mx-auto px-6 py-12">
      <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
        <div>
          <h3 class="text-xl font-bold">Always open for a chat — let's connect!</h3>
          <p class="mt-1 opacity-90">You can reach me anytime via email, LinkedIn, or by strolling around Ghent.</p>
        </div>
        <div class="flex gap-3">
          <a href="mailto:j.beaufays@outlook.com"
            class="bg-white text-[var(--color-accent1)] py-2 px-4 rounded-md font-semibold">Email me</a>
          <a href="https://www.linkedin.com/in/jarne-beaufays-404153152" target="_blank"
            class="bg-white/20 hover:bg-white/30 py-2 px-4 rounded-md">LinkedIn</a>
          <a href="resume.html" target="_blank" class="bg-white/20 hover:bg-white/30 py-2 px-4 rounded-md">Resume</a>
        </div>
      </div>
      <div class="mt-8 flex flex-col sm:flex-row items-center justify-between gap-3 text-sm opacity-80">
        <div>&copy; Jarne Beaufays — 2025</div>
        <div>This website's design and colors are inspired by a painting created by my grandfather.</div>
      </div>
    </div>
  </footer>

  <!-- === Floating section navigation arrows === -->
  <button id="arrowDown" class="scroll-arrow down" aria-label="Go to next section" title="Next section">↓</button>
  <button id="arrowUp" class="scroll-arrow up hidden" aria-label="Go to previous section" title="Previous section">↑</button>

  <script>
    // Build scroll targets: hero header + every <section> inside <main>
    const scrollTargets = Array.from(document.querySelectorAll("header.site-header, main section"));

    const arrowDown = document.getElementById("arrowDown");
    const arrowUp   = document.getElementById("arrowUp");

    function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }

    function getCurrentIndex() {
      let idx = 0;
      let best = Infinity;
      for (let i = 0; i < scrollTargets.length; i++) {
        const rect = scrollTargets[i].getBoundingClientRect();
        const dist = Math.abs(rect.top);
        if (dist < best) { best = dist; idx = i; }
      }
      return idx;
    }

    // Read a "type name" from a target element so we can map to a color
    function getTypeFromElement(el) {
      if (el.matches("header.site-header")) {
        return "Industry Projects"; // hero default
      }
      const h2 = el.querySelector("h2");
      return (h2?.textContent || "").trim();
    }

    // Apply color to both arrows
    function applyArrowColorsForIndex(i) {
      const el = scrollTargets[i];
      const typeName = getTypeFromElement(el);
      const cssVarName = getPrimaryAccentColor(typeName) || "--color-accent1";
      const color = `var(${cssVarName})`;
      arrowDown.style.background = color;
      arrowUp.style.background = color;
    }

    function scrollToIndex(i) {
      i = clamp(i, 0, scrollTargets.length - 1);
      scrollTargets[i].scrollIntoView({ behavior: "smooth", block: "start" });
      applyArrowColorsForIndex(i);
    }

    function updateArrows() {
      const i = getCurrentIndex();
      arrowUp.classList.toggle("hidden", i === 0);
      const atBottom = (window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 2);
      arrowDown.classList.toggle("hidden", i === scrollTargets.length - 1 || atBottom);
      applyArrowColorsForIndex(i);
    }

    arrowDown.addEventListener("click", () => {
      const i = getCurrentIndex();
      scrollToIndex(i + 1);
    });
    arrowUp.addEventListener("click", () => {
      const i = getCurrentIndex();
      scrollToIndex(i - 1);
    });

    let ticking = false;
    window.addEventListener("scroll", () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateArrows();
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });

    window.addEventListener("load", updateArrows);
    window.addEventListener("resize", updateArrows);
  </script>

</body>
</html>
